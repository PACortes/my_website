---
title: "Grafico de dispersión"
date: '2020-12-01T21:13:14-05:00'
categories: R
tags:
- Visualización
- ggplot
output:
  blogdown::html_page:
    toc: true
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

# 1. Definición
Los gráficos de dispersión (*scatterplot* en inglés) se utilizan para observar asociación entre dos variablesnuméricas diferentes. 

La posición de cada punto en el eje horizontal y vertical indica valores para una misma unidad experimental.

Recordemos que antes de realizar nuestro gráfico, debemos cargar la libreía ggplot2 usando la función `library()`.

```{r }
library(ggplot2)
```

# 2. Sintáxis 

La sintáxis básica de ggplot2 para generar un gráfico de dipersión es:

`ggplot(data, mapping=aes(x,y))+ geom_point()`

En donde:

* `data`: es la base de datos.

* `aes()`: especifica las variables en los ejes x e y.

* `+`: Da aviso a R para que suga leyendo el código, ya que se agregará una nueva capa.

* `geom_point()`: Especifica que queremos generar un gráfico de dispersión.


# 3. Visualización 
Generemos un gráfico de dispersión con las variables **Petal.Length** y **Petal.Width** de la base de datos `iris`.

```{r}
ggplot(data=iris, mapping =aes(x=Petal.Length, y =Petal.Width))+geom_point()
```


## 3.1. Límites de los ejes

Ahora
```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point()+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
labs(title="Largo vs Ancho del Pétalo", 
       x="Largo de Pétalo (cms)",
       y="Ancho de Pétalo (cms)")
```


## 3.1. Título y etiquetas
Las etiquetas por defecto de los ejes mostrará los nombres de las variables. Ahora bien, podemos personalizar las etiquetas de los ejes, e incluso el título del gráfico, con la función `labs()`:

```{r}

ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point()+
  labs(title="Largo vs Ancho del Pétalo", 
       x="Largo de Pétalo (cms)",
       y="Ancho de Pétalo (cms)")
```


Ahora, aumentemos el tamaños de las letras de títulos (y su color) y etiquetas con a función `theme()`, la cuál nos permite controlar aspectos como fuentes, marcas, fondos, entre muchos otros. 

`theme()` incluye dos componentes principales:

* **Elementos del tema**: especifica los elementos que queremos controlar.Por ejemplo, `plot.title` controla la apariencia del título. 

* **Función del tema**: describe la propiedad visual del elemento que queremos controlar.Por ejemplo, `element_text()` establece el tamaño de fuente, el color, entre otros:


  + Para cambiar el tamaño de un elemento, utilizamos la función `size =`.

  + Para cambiar el color de un elemento, utilizamos la función `color =`.
  
  + Para cambiar la familia de letra de un elemento, utilizamos `family =`.
  
  + Para cambiar el tipo de letra de un elemento, utilizamos `face =`.
  
    + Para cambiar el tipo de línea, utilizamos `linetype =`.
  
  
```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point()+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Pétalo", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25,colour="darkblue"))
```


## 3.4. Tamaño de los puntos
Para cambiar el tamaño de los puntos (aumentar o disminuir), utilizamos la función `size =`(valor por defecto:0.5) dentro de `geom_point()`. 

Por ejemplo, podemos especificar que todos los puntos tendrán un diamtero de 2.5

```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(size=2.5)+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Pétalo", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        plot.subtitle=element_text(size=20))
```

También, podríamos especificar diferentes tamaños según un valor específico de una de nuestras variables. Para ello debemos incorporar una dimensión `aes()` dentro de `geom_point()`.


```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(aes(size=Petal.Length>2.5))+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Pétalo", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        plot.subtitle=element_text(size=20))
```

También, podemos 


## 3.5. Color de los puntos

Ajustemos el tamaño y color de los puntos


```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(col="steelblue", size=2.5)+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Pétalo", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        plot.subtitle=element_text(size=20))
```

De acuerdo a categorías en otra variable.

```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(aes(col=Species), size=2.5)+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Pétalo", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        plot.subtitle=element_text(size=20))
```
De acuerdo a categorías en otra variable con valores específicos.

Ajustemos manualmente color de los puntos de acuerdo a categorías en otra variable

```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(aes(col=Species), size=2.5)+
  scale_colour_manual(values=c("#BC3C29FF", "#0072B5FF","#E18727FF"))+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Pétalo", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        plot.subtitle=element_text(size=20))
```



Ajustemos manualmente color de los puntos de acuerdo a categorías en otra variable

```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(aes(col=Species), size=2.5)+
  scale_colour_manual(values=c("#BC3C29FF", "#0072B5FF","#E18727FF"))+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Mi primer gráfico en R", 
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        legend.position = c(0.13, 0.85),
        legend.box.background = element_rect(fill = "transparent", colour = "#333333",size=1.2),
        legend.title = element_text(size = 15),
        legend.text = element_text(size = 12))
```


# 4. Juntando todas las piezas

```{r}
ggplot(data = iris, mapping=aes(x=Petal.Length , y =Petal.Width))+
  geom_point(aes(col=Species), size=2.5)+
  scale_colour_manual(values=c("#BC3C29FF", "#0072B5FF","#E18727FF"))+
  xlim(c(0, 8))+
  ylim(c(0, 3))+
  labs(title="Largo vs Ancho del Petalo",
       y="Ancho (cms)", x="Largo (cms)")+
  theme(axis.text =element_text(size=16),
        axis.title=element_text(size=23),
        plot.title=element_text(size=25),
        legend.position = c(0.13, 0.85),
        legend.box.background = element_rect(fill = "transparent", colour = "#333333",size=1.2),
        axis.line = element_line(color = "#333333",size = 1, linetype = "solid"))
```


# 5. Referencias

* Theme elements [https://ggplot2.tidyverse.org/reference/element.html]

